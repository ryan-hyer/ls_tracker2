<h1>
  <%= link_to "<span class='glyphicon glyphicon-pencil'></span> Edit".html_safe, edit_client_path(@client), class: "btn btn-warning pull-right", title: "Edit Client Information", data: { toggle: "modal", load_remote: edit_client_path(@client) } %>
  Client Information
</h1>

<%= "<div class='delisted'>De-Listed</div>".html_safe if @client.delisted %>
<%= "<div class='delisted'>Suspended</div>".html_safe if @client.suspended %>
<div class="row" id="client-info">
  <div class="col-md-6">
    <div class="row">
      <div class="col-md-4"><strong>Company</strong></div>
      <div class="col-md-8">
        <strong><%= @client.name %></strong>
        <%= simple_format(@client.address, {}, wrapper_tag: "div") %>
        Tel: <%= @client.phone %></br />
        Web: <%= link_to @client.website.to_s, @client.website %>
      </div>
    </div>
    <div class="row">
      <div class="col-md-4"><strong>Listing Number</strong></div>
      <div class="col-md-8">
        <strong><%= @client.listing_number %></strong><br />
        Effective Date: <%= @client.effective %><br />
        Last Updated: <%= @client.updated %><br />
        <%= "Expires: #{@client.expires}" if @client.expires %>
      </div>
    </div>
  </div>
  <div class="col-md-6">
    <div class="row">
      <div class="col-md-4"><strong>Listing Contact</strong></div>
      <div class="col-md-8">
        <%= @client.poc_name %><br />
        <%= "#{@client.poc_title}<br />".html_safe unless @client.poc_title.blank? %>
        <%= "#{@client.poc_phone}<br />".html_safe unless @client.poc_phone.blank? %>
        <%= mail_to(@client.poc_email) unless @client.poc_email.blank? %>        
      </div>
    </div>
    <div class="row">
      <div class="col-md-4"><strong>Invoicing Schedule</strong></div>
      <div class="col-md-8">
        $<%= @client.invoice_amt %> 
        <%= @client.invoice_freq.gsub(/Annual/, "Annually") %>
        <%= " (in #{@client.invoice_month})" if @client.invoice_freq == "Annual" %>
      </div>
    </div>
    <div class="row">
      <div class="col-md-4"><strong>Comments</strong></div>
      <div class="col-md-8">
        <%= simple_format(@client.comments, {}, wrapper_tag: "div") %>
      </div>
    </div>
  </div>
</div>

<!-- Listing Categories -->
<h1>
  <%= link_to "<span class='glyphicon glyphicon-plus'></span> New".html_safe, new_client_listing_path(@client), class: "btn btn-success btn-sm pull-right", title: "Add New Category", data: { toggle: "modal", load_remote: new_client_listing_path(@client) } %>
  Listing Categories
</h1>
<div id="client-listings">
<% @client.listings.each do |listing| %>
  <div class="row">
    <div class="listing-header">
      <%= link_to "<span class='glyphicon glyphicon-trash'></span>".html_safe, listing, method: :delete, class: "btn btn-danger btn-xs pull-right", title: "Delete Listing", data: { confirm: 'Are you sure you want to delete this listing category?' } %>
      <%= link_to "<span class='glyphicon glyphicon-pencil'></span>".html_safe, edit_listing_path(listing), class: "btn btn-warning btn-xs pull-right", title: "Edit Listing Information", data: { toggle: "modal", load_remote: edit_listing_path(listing) } %>
      <%= listing.category.with_scheme %>
    </div>
    <table class="table table-condensed">
      <tr>
        <td>Standards</td>
        <td>
          <ul class="standard-list">
            <% #listing.standards.each_with_index do |standard| %>
              <li>
              <%#= "<strong>#{number}</strong>-#{revision} - <em>#{title}</em>" %>
              <%#= " (#{exceptions})" if exceptions.present? %>
              Standard 1
              </li>
              <li>Standard 2</li>
            <% #end %>
          </ul>
        </td>
      </tr>
      <tr>
        <td>Product Description</td>
        <td><%= listing.product_description %></td>
      </tr>
      <tr>
        <td>Model Numbers</td>
        <td>2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 15, 15M, 17, 18, 19, 20, 22, 24, 25, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 38, 39, 40, 41, 43, 44, 46, 47, 48, 50, 53, 54, 56, 56A, 58, 60, 62, 64, 64M, 65, 66, 69, 73, 74, 76, 78, 79, 80, 84, 85, 86, 89, 94, 96, 100, 101, 103, 105, 106, 107 112A, 116, 117, 119, 122, 124, 125, 127, 128, 129M, 130, 131, 132, 133, 138, 139, 142, 143, 145, 146, 149M, 152, 164, 175, 186, 190, 191, 193A, 199, 200, 516, 519A, 523, 534, 537A, 544A, 548M, 549A, 550, 567M, 568M, 570, 571A, 584, 587A, 594A, 598, 599, 1001, 1007, 1008, 1010, 1011, 1012, 1014, 1020, 1026, 1028, 1029, 1033, 1034, 1039, 1044, 1047, 1048, 1068, 1081, 1089R, 1200, 1202, 1203, 1205, 1209, 1219, 1228, 1232, 1233, 1234, 1239</td>
      </tr>
      <tr>
        <td>Listing Conditions</td>
        <td><%= simple_format(listing.conditions, {}, wrapper_tag: "div") %></td>
      </tr>
      <tr>
        <td>Comments</td>
        <td><%= simple_format(listing.comments, {}, wrapper_tag: "div") %></td>
      </tr>
    </table>
  </div>
<% end %>
</div>

<!-- Manufacturing Facilities -->
<h1>
  <%= link_to "<span class='glyphicon glyphicon-plus'></span> New".html_safe, new_client_facility_path(@client), class: "btn btn-success btn-sm pull-right", title: "Add New Facility", data: { toggle: "modal", load_remote: new_client_facility_path(@client) } %>
  Manufacturing Facilities
</h1>
<div id="active-facilities">
  <%= render 'facilities', object: @client.facilities.active %>
</div>
<% unless @client.facilities.inactive.empty? %>
  <div class="facility-inactive-header" data-toggle="collapse" data-target="#inactive-facilities">
    <%= pluralize(@client.facilities.inactive.count, "inactive facility") + " (click to view/hide)" %>
  </div>
  <div id="inactive-facilities" class="collapse">
    <%= render 'facilities', object: @client.facilities.inactive %>
  </div>
<% end %>


<!-- Project Log -->
<h1>
  <%= link_to "<span class='glyphicon glyphicon-plus'></span> New".html_safe, edit_client_path(@client), class: "btn btn-success btn-sm pull-right", title: "Add New Project" %>
  Project Log
</h1>


<!-- Invoice Log -->
<h1>
  <%#= link_to "<span class='glyphicon glyphicon-plus'></span> New".html_safe, edit_client_path(@client), class: "btn btn-success btn-sm pull-right", title: "Add New Invoice" %>
  Invoice Log
</h1>
<table class="table table-striped table-condensed">
  <thead>
    <tr>
      <th>Invoice Number</th>
      <th>Invoice Date</th>
      <th>Description</th>
      <th>Amount</th>
      <th>Date Paid</th>
    </tr>
  </thead>

  <tbody>
    <% @client.invoices.each do |invoice| %>
      <tr>
        <td><%= invoice.number %></td>
        <td><%= invoice.date_invoiced %></td>
        <td><%= invoice.description %></td>
        <td><%= number_to_currency(invoice.amount) %></td>
        <td><%= invoice.date_paid %></td>
      </tr>
    <% end %>
  </tbody>
</table>


<%= render 'shared/modal' %>